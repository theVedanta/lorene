<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lorene Pay - User Settings</title>
    <link
      href="https://fonts.googleapis.com/css?family=Poppins:200,400,500,600,700,900"
      rel="stylesheet"
    />
    <link
      href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    />

    <link href="../../css/bootstrap.min.css" rel="stylesheet" />
    <link href="./../css/paper-dashboard.min.css?v=2.0.1" rel="stylesheet" />
    <link rel="stylesheet" href="/css/settings.css">
  </head>
  <body>
    <div class="wrapper">
      <div class="sidebar" data-color="white" data-active-color="danger">
        <div class="logo" style="display: flex; justify-content: space-between">
          <div class="ff">
            <a href="/account" class="simple-text logo-mini">
              <% if (user.logo) { %>
              <img src="/img/<%= user.logo %>" alt="" />
              <% } else { %>
              <img style="width: 70%" src="../assets/logoT.svg" alt="" />
              <% } %>
            </a>
            <a href="/account" class="simple-text logo-normal">
              <%= user.name %>
            </a>
          </div>
          <div
            style="
              display: flex;
              justify-content: center;
              align-items: center;
              transform: translateY(-10%);
              margin-right: 1vw;
            "
            class="prof-opts"
          >
            <i
              style="font-size: 18px; cursor: pointer"
              class="fas fa-chevron-down"
            ></i>
          </div>
        </div>
        <div class="sidebar-wrapper">
          <ul class="side-opts">
            <li><a href="/change-pw">Change Password</a></li>
            <li><a href="/logout">Logout</a></li>
          </ul>
          <ul class="nav">
            <li>
              <a href="/dashboard">
                <i class="fas fa-home"></i>
                <p>Home</p>
              </a>
            </li>
            <li>
              <a href="/transactions">
                <i class="fas fa-money-check-alt"></i>
                <p>Transactions</p>
              </a>
            </li>
            <li>
              <a href="/settlements">
                <i class="fas fa-business-time"></i>
                <p>Settlements</p>
              </a>
            </li>
            <li>
              <a href="/refunds">
                <i class="fas fa-exchange-alt"></i>
                <p>Refunds</p>
              </a>
            </li>
            <li>
              <a href="/quotations">
                <i class="fas fa-tags"></i>
                <p>Quotations</p>
              </a>
            </li>
            <li>
              <a href="/proforma">
                <i class="fas fa-file-invoice"></i>
                <p>Proforma Invoices</p>
              </a>
            </li>
            <li>
              <a href="/invoices">
                <i class="fas fa-file-invoice-dollar"></i>
                <p>Invoices</p>
              </a>
            </li>
            <li>
              <a href="/paylinks">
                <i class="fas fa-paperclip"></i>
                <p>Payment Links</p>
              </a>
            </li>
            <li>
              <a href="/pages">
                <i class="fas fa-newspaper"></i>
                <p>Pages</p>
              </a>
            </li>
            <li>
              <a href="/customers">
                <i class="fas fa-user-friends"></i>
                <p>Customers</p>
              </a>
            </li>
            <li>
              <a href="/account">
                <i class="fas fa-user-cog"></i>
                <p>My Account</p>
              </a>
            </li>
            <li class="active">
              <a href="#">
                <i class="fas fa-cog"></i>
                <p>Settings</p>
              </a>
            </li>
          </ul>
        </div>
      </div>

      <div class="main-panel">
        <nav
          class="
            navbar navbar-expand-lg navbar-absolute
            fixed-top
            navbar-transparent
          "
        >
          <div class="container-fluid">
            <div class="navbar-wrapper">
              <div class="navbar-toggle">
                <button type="button" class="navbar-toggler">
                  <span class="navbar-toggler-bar bar1"></span>
                  <span class="navbar-toggler-bar bar2"></span>
                  <span class="navbar-toggler-bar bar3"></span>
                </button>
              </div>
            </div>
          </div>
        </nav>

        <div class="content">
          <div class="row">
            <div class="col">
              <div class="card card-stats">
                <div class="card-head">
                  <div class="left">
                    <h4><i class="fas fa-cog"></i>&nbsp;&nbsp;Settings</h4>
                  </div>
                </div>

                <h4 id="error" style="color: #e34f4f"><%= msg %></h4>

                <div class="acc-pages">
                  <button class="acc-act">Address</button>
                  <button>Bank Info</button>
                  <button>Logo</button>
                  <button>Taxes</button>
                </div>

                <div class="address org">
                  <form
                    action="/settings/address?_method=PUT"
                    method="POST"
                    class="detail-box"
                  >
                    <% if (user.address) { %>
                    <div class="unit">
                      <h5>Address Line 1</h5>
                      <span>:</span>
                      <div class="input">
                        <input
                          type="text"
                          name="line1" readonly
                          value="<%= user.address.line1 ? user.address.line1 : '' %>"
                        />
                      </div>
                    </div>

                    <div class="unit">
                      <h5>Address Line 2</h5>
                      <span>:</span>
                      <div class="input">
                        <input
                          type="text" readonly
                          name="line2"
                          value="<%= user.address.line2 ? user.address.line2 : '' %>"
                        />
                      </div>
                    </div>

                    <div class="unit">
                      <h5>City</h5>
                      <span>:</span>
                      <div class="input">
                        <input
                          type="text" readonly
                          name="city"
                          value="<%= user.address.city ? user.address.city : '' %>"
                        />
                      </div>
                    </div>

                    <div class="unit">
                      <h5>ZIP Code</h5>
                      <span>:</span>
                      <div class="input">
                        <input
                          type="text" readonly
                          name="zip"
                          value="<%= user.address.zip ? user.address.zip : '' %>"
                        />
                      </div>
                    </div>

                    <div class="unit">
                      <h5>State</h5>
                      <span>:</span>
                      <div class="input">
                        <input type="text" name="state" required readonly value="<%= user.address.state ? user.address.state : "" %>">
                      </div>
                    </div>
                    <% } else { %>
                    <div class="unit">
                      <h5>Address Line 1</h5>
                      <span>:</span>
                      <div class="input">
                        <input type="text" name="line1" required />
                      </div>
                    </div>

                    <div class="unit">
                      <h5>Address Line 2</h5>
                      <span>:</span>
                      <div class="input">
                        <input type="text" name="line2" required />
                      </div>
                    </div>

                    <div class="unit">
                      <h5>City</h5>
                      <span>:</span>
                      <div class="input">
                        <input type="text" name="city" required />
                      </div>
                    </div>

                    <div class="unit">
                      <h5>ZIP Code</h5>
                      <span>:</span>
                      <div class="input">
                        <input type="text" name="zip" required />
                      </div>
                    </div>

                    <div class="unit">
                      <h5>State</h5>
                      <span>:</span>
                      <div class="input">
                        <select required name="state">
                          <option value="">None</option>
                          <option value="Andhra Pradesh">Andhra Pradesh</option>
                          <option value="Andaman and Nicobar Islands">
                            Andaman and Nicobar Islands
                          </option>
                          <option value="Arunachal Pradesh">
                            Arunachal Pradesh
                          </option>
                          <option value="Assam">Assam</option>
                          <option value="Bihar">Bihar</option>
                          <option value="Chandigarh">Chandigarh</option>
                          <option value="Chhattisgarh">Chhattisgarh</option>
                          <option value="Dadar and Nagar Haveli">
                            Dadar and Nagar Haveli
                          </option>
                          <option value="Daman and Diu">Daman and Diu</option>
                          <option value="Delhi">Delhi</option>
                          <option value="Lakshadweep">Lakshadweep</option>
                          <option value="Puducherry">Puducherry</option>
                          <option value="Goa">Goa</option>
                          <option value="Gujarat">Gujarat</option>
                          <option value="Haryana">Haryana</option>
                          <option value="Himachal Pradesh">
                            Himachal Pradesh
                          </option>
                          <option value="Jammu and Kashmir">
                            Jammu and Kashmir
                          </option>
                          <option value="Jharkhand">Jharkhand</option>
                          <option value="Karnataka">Karnataka</option>
                          <option value="Kerala">Kerala</option>
                          <option value="Madhya Pradesh">Madhya Pradesh</option>
                          <option value="Maharashtra">Maharashtra</option>
                          <option value="Manipur">Manipur</option>
                          <option value="Meghalaya">Meghalaya</option>
                          <option value="Mizoram">Mizoram</option>
                          <option value="Nagaland">Nagaland</option>
                          <option value="Odisha">Odisha</option>
                          <option value="Punjab">Punjab</option>
                          <option value="Rajasthan">Rajasthan</option>
                          <option value="Sikkim">Sikkim</option>
                          <option value="Tamil Nadu">Tamil Nadu</option>
                          <option value="Telangana">Telangana</option>
                          <option value="Tripura">Tripura</option>
                          <option value="Uttar Pradesh">Uttar Pradesh</option>
                          <option value="Uttarakhand">Uttarakhand</option>
                          <option value="West Bengal">West Bengal</option>
                        </select>
                      </div>
                    </div>
                    <% } %>
                    <% if (!user.address) { %>
                    <button class="btn btn-primary" type="submit">
                      Submit
                    </button>
                    <% } %>
                  </form>
                </div>

                <div style="display: none" class="bank org">
                  <form
                    action="/settings/bank?_method=PUT"
                    method="POST"
                    class="detail-box"
                  >
                    <% if (!user.bankInfo) { %>
                    <h4 class="wait" style="color: #E52A2A">Please upload bank information</h4>
                    <% } %>
                    <% if (user.bankInfo) { %>
                      <% if (!user.verified) { %>
                      <h4 class="wait" style="color: red">
                        Please wait for us to verify your account
                      </h4>
                      <% } %>

                      <div class="unit">
                        <h5>Account Number</h5>
                        <span>:</span>
                        <div class="input">
                          <input <%= user.verified ? "readonly" : "" %>
                          required
                          type="number"
                          name="number"
                          value="<%=
                          user.bankInfo.number %>" />
                        </div>
                      </div>

                      <div class="unit">
                        <h5>Account Type</h5>
                        <span>:</span>
                        <div class="input">
                          <input type="text" name="type" <%= user.verified ? "readonly" : "" %> value="<%= user.bankInfo.type ? user.bankInfo.type : "" %>">
                        </div>
                      </div>

                      <div class="unit">
                        <h5>IFSC Code</h5>
                        <span>:</span>
                        <div class="input">
                          <input <%= user.verified ? "readonly" : "" %>
                            required
                            type="text"
                            name="ifsc"
                            value="<%= user.bankInfo.ifsc %>"
                          />
                        </div>
                      </div>

                      <% if (!user.verified) { %>
                        <h3 class="btn btn-secondary mb-4" id="search">Search</h3>
                      <% } %>

                      <div style="width: 100%" class="bankDetails">

                          <div class="unit">
                            <h5>Bank Name</h5>
                            <span>:</span>
                            <div class="input">
                              <input
                                readonly
                                name="bankName"
                                id="bankName"
                                value="<%= user.bankInfo.bankName %>"
                              />
                            </div>
                          </div>

                          <div class="unit">
                            <h5>Bank Branch</h5>
                            <span>:</span>
                            <div class="input">
                              <input
                                readonly
                                name="bankBranch"
                                id="bankBranch"
                                value="<%= user.bankInfo.bankBranch %>"
                              />
                            </div>
                          </div>

                          <div class="unit">
                            <h5>Bank Address</h5>
                            <span>:</span>
                            <div class="input">
                              <input
                                readonly
                                name="bankAddress"
                                id="bankAddress"
                                value="<%= user.bankInfo.bankAddress %>"
                              />
                            </div>
                          </div>

                        <% if (!user.verified) { %>
                        <button class="btn btn-primary" type="submit">
                          Save Changes
                        </button>
                        <% } %>
                      </div>

                    <% } else { %>
                      <div class="unit">
                        <h5>Account Number</h5>
                        <span>:</span>
                        <div class="input">
                          <input <%= user.verified ? "readonly" : "" %>
                          required
                          type="number"
                          name="number" />
                        </div>
                      </div>

                      <div class="unit">
                        <h5>Account Type</h5>
                        <span>:</span>
                        <div class="input">
                          <select required name="type" <%= user.verified ? "readonly" : "" %>>
                            <option value="savings">Savings</option>
                            <option value="current">Current</option>
                          </select>
                        </div>
                      </div>

                      <div class="unit">
                        <h5>IFSC Code</h5>
                        <span>:</span>
                        <div class="input">
                          <input <%= user.verified ? "readonly" : "" %>
                            required
                            type="text"
                            name="ifsc"
                          />
                        </div>
                      </div>

                      <h3 class="btn btn-secondary" id="search">Search</h3>

                      <div style="width: 100%" class="bankDetails" id="the">

                          <div class="unit">
                            <h5>Bank Name</h5>
                            <span>:</span>
                            <div class="input">
                              <input
                                readonly
                                name="bankName"
                                id="bankName"
                              />
                            </div>
                          </div>

                          <div class="unit">
                            <h5>Bank Branch</h5>
                            <span>:</span>
                            <div class="input">
                              <input
                                readonly
                                name="bankBranch"
                                id="bankBranch"
                              />
                            </div>
                          </div>

                          <div class="unit">
                            <h5>Bank Address</h5>
                            <span>:</span>
                            <div class="input">
                              <input
                                readonly
                                name="bankAddress"
                                id="bankAddress"
                              />
                            </div>
                          </div>

                        <button class="btn btn-primary mb-5" type="submit">
                          Save Changes
                        </button>
                      </div>
                    <% } %>
                  </form>
                </div>

                <div style="display: none" class="logo-up org">
                    <form
                    action="/settings/logo?_method=PUT"
                    enctype="multipart/form-data"
                    method="POST" class="detail-box"
                  >
                    <% if (user.logo) { %>
                    <div class="unit">
                      <h5 style="margin-bottom: 2vh">Current Logo:</h5>
                      <span>:</span>
                      <div class="input" style="display: flex;flex-direction: row; align-items: center">
                        <img
                          style="max-width: 100%; max-height: 30vh"
                          src="/img/<%= user.logo %>"
                          alt="Logo"
                        />
                        <h3 id="remove-logo" class="btn btn-danger text-white ml-4" style="height: 100%;"><i class="fas fa-trash"></i>&nbsp;Remove</h3>
                      </div>
                    </div>
                    <% } %>
                    <div class="unit">
                      <h5 for="logo"><%= user.logo ? "Change" : "Upload" %> Logo:</h5>
                      <span>:</span>
                      <div class="input file-inp-hold">
                        <input
                          type="file"
                          name="logo"
                          class="file-inp"
                          accept="image/gif, image/jpeg, image/png, image/webp"
                          onchange="logoUpload(event)"
                        />
                        <img style="max-width: 100%; max-height: 30vh" id="#logo" />
                      </div>
                    </div>
                    <button class="btn btn-primary" type="submit">
                        Save Changes
                      </button>
                  </form>
                </div>

                <div style="display: none" class="tax">
                  <div class="min-head">
                  <div class="left">
                    <h4>Taxes</h4>
                  </div>
                  <div class="right">
                    <button id="taxCreate" style="padding-top:1.2vh; padding-bottom:1.2vh;" class="btn btn-primary">
                      <i class="fas fa-plus"></i>&nbsp;&nbsp;Create Tax
                    </button>
                  </div>
                </div>
                  <div class="table-cont">
                  <div class="table-responsive">
                    <table cellpadding="0" cellspacing="0" class="table">
                      <thead class="text-primary">
                        <tr>
                          <th style="text-align: left">Tax Name</th>
                          <th style="text-align: left">Tax Offer</th>
                          <th style="text-align: left">Status</th>
                          <th style="text-align: left">Action</th>
                        </tr>
                      </thead>
                      <tbody>
                        <% for (let tax of taxes) { %>
                          <tr>
                            <td><%= tax.name %></td>
                            <td><%= tax.offer %></td>
                            <td class="togg">
                            <span><%= tax.active %></span>
                            <button
                              class="toggle"
                              onclick="tx(`<%= tax.id %>`, this)"
                            ></button></td>
                            <td>
                              <button class="btn btn-primary" onclick="te(`<%= tax.name %>`, `<%= tax.offer %>`, `<%= tax.id %>`)"><i class="fas fa-pen"></i>&nbsp; Edit</button>
                              <button class="btn btn-danger" onclick="td(`<%= tax.id %>`, this)"><i class="fas fa-trash"></i>&nbsp; Delete</button>
                            </td>
                          </tr>
                        <% } %>
                      </tbody>
                    </table>
                  </div>
                </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <form class="add-tax">
      <div class="card-head">
        <h3>Create New tax</h3>
      <i class="fas fa-times text-secondary"></i>
      </div>
      <div style="margin-top:2vh;" class="unit">
        <h5>Tax Name</h5>
        <span>:</span>
        <div class="input">
          <input type="text" required name="name">
        </div>
      </div>
      <div class="unit">
        <h5>Tax Amt.&nbsp;(%)</h5>
        <span>:</span>
        <div class="input">
          <input required type="number" name="offer" value="0" />
        </div>
      </div>
      <div style="display: flex; align-items: center">
        <h5 class="btn btn-primary text-white" id="makeTax">Create</h5>
        <p class="text-danger"></p>
      </div>
    </form>

    <form class="edit-tax">
      <div class="card-head">
        <h3>Edit tax</h3>
        <i class="fas fa-times text-secondary"></i>
      </div>
      <div class="unit">
        <h5>Tax Name</h5>
        <span>:</span>
        <div class="input">
          <input type="text" required name="name">
        </div>
      </div>
      <div class="unit">
        <h5>Tax Amt.&nbsp;(%)</h5>
        <span>:</span>
        <div class="input">
          <input required type="number" name="offer" value="0" />
        </div>
      </div>
      <div style="display: flex; align-items: center">
        <h5 class="btn btn-primary text-white" id="editTax">Save Changes</h5>
        <h1 id="editVal" style="display: none"></h1>
        <p class="text-danger"></p>
      </div>
    </form>

    <script src="../../js/core/jquery.min.js"></script>
    <script src="../../js/core/popper.min.js"></script>
    <script src="../../js/core/bootstrap.min.js"></script>
    <script src="../../js/paper-dashboard.min.js?v=2.0.1"></script>
    <script src="../../js/settings.js"></script>
  </body>
</html>
